{"version":3,"sources":["webpack:///D:/WeChat/文件备份/WeChat Files/wxid_19c3c5m8aigw12/FileStorage/File/2025-06/uni-app/pages/goods/order_pay_status/components/giftModal.vue?f2c7","webpack:///D:/WeChat/文件备份/WeChat Files/wxid_19c3c5m8aigw12/FileStorage/File/2025-06/uni-app/pages/goods/order_pay_status/components/giftModal.vue?be30","webpack:///D:/WeChat/文件备份/WeChat Files/wxid_19c3c5m8aigw12/FileStorage/File/2025-06/uni-app/pages/goods/order_pay_status/components/giftModal.vue?6095","webpack:///D:/WeChat/文件备份/WeChat Files/wxid_19c3c5m8aigw12/FileStorage/File/2025-06/uni-app/pages/goods/order_pay_status/components/giftModal.vue?a4f4","uni-app:///pages/goods/order_pay_status/components/giftModal.vue","webpack:///D:/WeChat/文件备份/WeChat Files/wxid_19c3c5m8aigw12/FileStorage/File/2025-06/uni-app/pages/goods/order_pay_status/components/giftModal.vue?f8d0","webpack:///D:/WeChat/文件备份/WeChat Files/wxid_19c3c5m8aigw12/FileStorage/File/2025-06/uni-app/pages/goods/order_pay_status/components/giftModal.vue?49c3"],"names":["data","aleartData","bag","giftBorder","giftbag","codeShow","cid","codeVal","size","unit","background","foreground","pdground","codeIcon","iconsize","lv","onval","loadMake","PromotionCode","posterImageStatus","posterImage","props","giftData","type","aleartStatus","default","watch","methods","copyLink","uni","qrR","console","posterImageClose","drawPoster","src","success","ctx","canvasId","width","height","resolve","fail","reject","loadImage","img","share","getPoster","i","url","postImg","goPoster","then","catch","savePosterPathMp","filePath","that","title","icon","savePic","a","document"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkI;AAClI;AAC6D;AACL;AACsC;;;AAG9F;AAC8N;AAC9N,gBAAgB,gNAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,gGAAM;AACR,EAAE,yGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC1BA;AAAA;AAAA;AAAA;AAA64B,CAAgB,kyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;ACuDj6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eACA;EACAA;IACA;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACAC;IACA;IACAC;MACAD;MACAE;IACA;EACA;EACAC;IACAF;MACA;QACA;MACA;QAQA;MAEA;IACA;EACA;EACAG;IACAC;MACAC;QACA7B;MACA;IACA;IACA8B;MACAC;IASA;IACA;IACAC;MACA;MACA;IACA;IAEAC;MACA;MACA;QACA;UACA;QACA;QACA;MACA;MACA;MACA;MACA;QAAA;UAAA;YAAA;cAAA;gBAAA;kBACAJ;oBACAK;oBACAC;sBACA;sBACA;sBACA;sBACA;sBACA;sBACAJ;sBACA;sBACAK;sBACAA;sBACA;;sBAEA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACAA;sBACA;sBACA;sBACA;sBACA;;sBAEA;sBACA;sBACA;;sBAEA;sBACA;sBACA;sBACA;sBACAA;sBACAA;sBACAA;sBACAA;sBACAA;sBACAA;;sBAEA;sBACAA;sBACAA;sBACAA;sBACA;sBACAA;sBACAA;;sBAEA;sBACA;;sBAEA;sBACA;sBACA;sBACAA;;sBAEA;sBACA;sBACA;sBACA;sBACA;sBACAA;;sBAEA;sBACA;sBACA;sBACA;sBACAA;sBACAA;sBACAA;sBACA;sBACA;sBACA;sBACA;sBACAA;;sBAEA;sBACAA;wBACAL;wBACA;wBACAF;0BACAQ;0BACAC;0BACAC;0BACAJ;4BACAJ;4BACAS;0BACA;0BAEAC;4BACAV;4BACAW;0BACA;wBACA;sBACA;oBACA;kBACA;gBAAA;gBAAA;kBAAA;cAAA;YAAA;UAAA;QAAA,CACA;QAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACA;QACA;QACAC;QACAA;QACAA;UACAb;UACAS;QACA;QACAI;UAAA;QAAA;MACA;IACA;IACAC;MACA;IACA;IACAC;MAAA;MACA;MACAf;MACA;MAAA,2BAEAgB;QACAlB;UACAmB;UACAb;YACA;cACAc;YACA;YACAlB;YACA;cAAA;YAAA;YACA;UACA;UACAU;YACA;UACA;QACA;MAAA;MAdA;QAAA;MAeA;IAKA;IACAS;MAAA;MACA,sEACAC;QACApB;QAEA;MAMA,GACAqB;QACArB;MACA;IACA;IAEAsB;MACA;MACAxB;QACAyB;QACAnB;UACAoB;YACAC;YACAC;UACA;QACA;QACAhB;UACAc;YACAC;UACA;QACA;MACA;IACA;IAEAE;MACA;MACAC;MACAA;MACAA;MACAC;MACAD;MACAA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACzUA;AAAA;AAAA;AAAA;AAA4rD,CAAgB,q7CAAG,EAAC,C;;;;;;;;;;;ACAhtD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/goods/order_pay_status/components/giftModal.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./giftModal.vue?vue&type=template&id=ac1b5c92&scoped=true&\"\nvar renderjs\nimport script from \"./giftModal.vue?vue&type=script&lang=js&\"\nexport * from \"./giftModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./giftModal.vue?vue&type=style&index=0&id=ac1b5c92&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ac1b5c92\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/goods/order_pay_status/components/giftModal.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./giftModal.vue?vue&type=template&id=ac1b5c92&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 =\n    _vm.aleartStatus && !_vm.posterImageStatus\n      ? _vm.$t(_vm.giftData.title)\n      : null\n  var m1 =\n    _vm.aleartStatus && !_vm.posterImageStatus ? _vm.$t(\"送给好友\") : null\n  var m2 =\n    _vm.aleartStatus && !_vm.posterImageStatus ? _vm.$t(\"保存海报\") : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n        m1: m1,\n        m2: m2,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./giftModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./giftModal.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"aleart\" v-if=\"aleartStatus\" :style=\"'background-image: url(' + giftbag + ');'\">\n\t\t<template v-if=\"!posterImageStatus\">\n\t\t\t<text class=\"iconfont icon-cha2 close\" @click=\"posterImageClose\"></text>\n\t\t\t<view class=\"from\">赠送给好友一份礼物</view>\n\t\t\t<view class=\"message\">{{ giftData.message }}</view>\n\t\t\t<view class=\"aleart-body\">\n\t\t\t\t<image class=\"goods-img\" :src=\"giftData.image\" mode=\"\"></image>\n\t\t\t</view>\n\t\t\t<view class=\"title line1\">\n\t\t\t\t{{ $t(giftData.title) }}\n\t\t\t</view>\n\t\t\t<!-- #ifdef H5 -->\n\t\t\t<view class=\"btn\" @click=\"copyLink()\">\n\t\t\t\t{{ $t('复制礼物链接') }}\n\t\t\t</view>\n\t\t\t<!-- #endif -->\n\t\t\t<!-- #ifndef H5 -->\n\t\t\t<button class=\"btn\" open-type=\"share\" hover-class=\"none\">\n\t\t\t\t{{ $t(`送给好友`) }}\n\t\t\t</button>\n\t\t\t<!-- #endif -->\n\t\t\t<view class=\"btn-clear\" @click=\"getPoster()\">\n\t\t\t\t{{ $t('保存海报') }}\n\t\t\t</view>\n\t\t</template>\n\t\t<template v-if=\"posterImageStatus\">\n\t\t\t<text class=\"iconfont icon-cha2 close\" @click=\"posterImageClose\"></text>\n\t\t\t<image class=\"poster-img\" :src=\"posterImage\"></image>\n\t\t\t<!-- #ifdef H5 -->\n\t\t\t<view class=\"keep\">{{ $t(`长按图片可以保存到手机`) }}</view>\n\t\t\t<!-- #endif -->\n\t\t</template>\n\t\t<!-- #ifdef H5 || APP-PLUS -->\n\t\t<zb-code\n\t\t\tref=\"qrcode\"\n\t\t\t:show=\"codeShow\"\n\t\t\t:cid=\"cid\"\n\t\t\t:val=\"codeVal\"\n\t\t\t:size=\"size\"\n\t\t\t:unit=\"unit\"\n\t\t\t:background=\"background\"\n\t\t\t:foreground=\"foreground\"\n\t\t\t:pdground=\"pdground\"\n\t\t\t:icon=\"codeIcon\"\n\t\t\t:iconSize=\"iconsize\"\n\t\t\t:onval=\"onval\"\n\t\t\t:loadMake=\"loadMake\"\n\t\t\t@result=\"qrR\"\n\t\t/>\n\t\t<!-- #endif -->\n\t</view>\n</template>\n\n<script>\nimport { HTTP_REQUEST_URL } from '@/config/app';\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\taleartData: {},\n\t\t\tbag: HTTP_REQUEST_URL + '/statics/images/canvas-bag.png',\n\t\t\tgiftBorder: HTTP_REQUEST_URL + '/statics/images/gift-border.png',\n\t\t\tgiftbag: HTTP_REQUEST_URL + '/statics/images/gift-bag.png',\n\t\t\t//二维码参数\n\t\t\tcodeShow: false,\n\t\t\tcid: '1',\n\t\t\tcodeVal: '', // 要生成的二维码值\n\t\t\tsize: 200, // 二维码大小\n\t\t\tunit: 'upx', // 单位\n\t\t\tbackground: '#FFF', // 背景色\n\t\t\tforeground: '#000', // 前景色\n\t\t\tpdground: '#000', // 角标色\n\t\t\tcodeIcon: '', // 二维码图标\n\t\t\ticonsize: 40, // 二维码图标大小\n\t\t\tlv: 3, // 二维码容错级别 ， 一般不用设置，默认就行\n\t\t\tonval: true, // val值变化时自动重新生成二维码\n\t\t\tloadMake: true, // 组件加载完成后自动生成二维码\n\t\t\tPromotionCode: '',\n\t\t\tposterImageStatus: false,\n\t\t\tposterImage: ''\n\t\t};\n\t},\n\tprops: {\n\t\tgiftData: {\n\t\t\ttype: Object\n\t\t},\n\t\taleartStatus: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\twatch: {\n\t\taleartStatus(status) {\n\t\t\tif (!status) {\n\t\t\t\tthis.aleartData = {};\n\t\t\t} else {\n\t\t\t\t// #ifdef H5\n\t\t\t\tthis.codeVal = window.location.origin + '/pages/goods/receive_gift/index?id=' + this.giftData.id + '&spid=' + this.$store.state.app.uid;\n\t\t\t\t// #endif\n\t\t\t\t// #ifdef APP-PLUS\n\t\t\t\tthis.codeVal = HTTP_REQUEST_URL + '/pages/goods/receive_gift/index?id=' + this.giftData.id + '&spid=' + this.$store.state.app.uid;\n\t\t\t\t// #endif\n\t\t\t\t// #ifdef MP\n\t\t\t\tthis.PromotionCode = this.giftData.code;\n\t\t\t\t// #endif\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\tcopyLink() {\n\t\t\tuni.setClipboardData({\n\t\t\t\tdata: this.codeVal\n\t\t\t});\n\t\t},\n\t\tqrR(res) {\n\t\t\tconsole.log(res);\n\t\t\t// #ifdef H5\n\t\t\tif (!this.$wechat.isWeixin() || this.shareQrcode != '1') {\n\t\t\t\tthis.PromotionCode = res;\n\t\t\t}\n\t\t\t// #endif\n\t\t\t// #ifdef APP-PLUS\n\t\t\tthis.PromotionCode = res;\n\t\t\t// #endif\n\t\t},\n\t\t//隐藏弹窗\n\t\tposterImageClose() {\n\t\t\tthis.posterImageStatus = false\n\t\t\tthis.$emit('close', false);\n\t\t},\n\n\t\tdrawPoster(loadedImages, name, store_name) {\n\t\t\t// 截断标题函数\n\t\t\tfunction truncateTitle(title, maxLength) {\n\t\t\t\tif (title.length > maxLength) {\n\t\t\t\t\treturn title.substring(0, maxLength) + '...';\n\t\t\t\t}\n\t\t\t\treturn title;\n\t\t\t}\n\t\t\t// 获取canvas上下文\n\t\t\tconst ctx = uni.createCanvasContext('posterCanvas');\n\t\t\treturn new Promise(async (resolve, reject) => {\n\t\t\t\tuni.getImageInfo({\n\t\t\t\t\tsrc: loadedImages[0],\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t// 海报尺寸\n\t\t\t\t\t\tconst posterWidth = 375;\n\t\t\t\t\t\tconst posterHeight = 579;\n\t\t\t\t\t\t// const posterWidth = res.width / 2;\n\t\t\t\t\t\t// const posterHeight = res.height / 2;\n\t\t\t\t\t\tconsole.log(posterWidth, posterHeight);\n\t\t\t\t\t\t// 绘制背景图\n\t\t\t\t\t\tctx.drawImage(loadedImages[0], 0, 0, posterWidth, posterHeight);\n\t\t\t\t\t\tctx.save();\n\t\t\t\t\t\t// 头像和标题的布局\n\n\t\t\t\t\t\tconst avatarSize = 22; // 头像尺寸\n\t\t\t\t\t\tconst nickname = name; // 昵称\n\t\t\t\t\t\tconst title = '赠送给好友一份礼物'; // 标题文字\n\t\t\t\t\t\tconst titleFontSize = 14; // 标题字号\n\t\t\t\t\t\tconst nicknameFontSize = 14; // 昵称字号\n\t\t\t\t\t\tconst padding = 10; // 元素之间的间距\n\t\t\t\t\t\t// 计算标题宽度\n\t\t\t\t\t\tctx.setFontSize(titleFontSize);\n\t\t\t\t\t\tconst titleWidth = ctx.measureText(title).width;\n\t\t\t\t\t\tconst nicknameWidth = ctx.measureText(nickname).width;\n\t\t\t\t\t\t// 计算头像和标题的总宽度\n\t\t\t\t\t\tconst totalWidth = avatarSize + padding + nicknameWidth + padding + titleWidth;\n\n\t\t\t\t\t\t// 计算起始绘制位置（水平居中）\n\t\t\t\t\t\tconst startX = (posterWidth - totalWidth) / 2;\n\t\t\t\t\t\tconst startY = 77; // 距离顶部的距离\n\n\t\t\t\t\t\t// 绘制头像\n\t\t\t\t\t\t// ctx.drawImage(loadedImages[3], startX, startY, avatarSize, avatarSize);\n\t\t\t\t\t\tconst avatarX = startX + avatarSize / 2; // 头像中心点 X\n\t\t\t\t\t\tconst avatarY = startY + avatarSize / 2; // 头像中心点 Y\n\t\t\t\t\t\tctx.save(); // 保存画布状态\n\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\tctx.arc(avatarX, avatarY, avatarSize / 2, 0, Math.PI * 2); // 绘制圆形路径\n\t\t\t\t\t\tctx.clip(); // 裁剪圆形区域\n\t\t\t\t\t\tctx.drawImage(loadedImages[3], startX, startY, avatarSize, avatarSize); // 绘制头像\n\t\t\t\t\t\tctx.restore(); // 恢复画布状态\n\n\t\t\t\t\t\t// 绘制昵称\n\t\t\t\t\t\tctx.setFontSize(nicknameFontSize);\n\t\t\t\t\t\tctx.setTextAlign('left');\n\t\t\t\t\t\tctx.fillText(nickname, startX + avatarSize + padding, startY + avatarSize - 5); // 调整文字垂直居中\n\t\t\t\t\t\t// 绘制标题\n\t\t\t\t\t\tctx.setFontSize(titleFontSize);\n\t\t\t\t\t\tctx.fillText(title, startX + avatarSize + padding + nicknameWidth + padding, startY + avatarSize - 5);\n\n\t\t\t\t\t\t// 商品图尺寸\n\t\t\t\t\t\tconst productImageSize = 225; // 商品图尺寸为 225px x 225px\n\n\t\t\t\t\t\t// 绘制商品图边框\n\t\t\t\t\t\tconst productBorderX = (posterWidth - productImageSize) / 2; // 水平居中\n\t\t\t\t\t\tconst productBorderY = startY + avatarSize + 31; // 距离头像和标题的间距\n\t\t\t\t\t\tctx.drawImage(loadedImages[1], productBorderX, productBorderY, productImageSize, productImageSize);\n\n\t\t\t\t\t\t// 绘制商品图\n\t\t\t\t\t\tconst productImagePadding = 10; // 商品图与边框的内边距\n\t\t\t\t\t\tconst productImageX = productBorderX + productImagePadding;\n\t\t\t\t\t\tconst productImageY = productBorderY + productImagePadding + 11;\n\t\t\t\t\t\tconst productImageInnerSize = productImageSize - 2 * productImagePadding; // 商品图实际绘制尺寸\n\t\t\t\t\t\tctx.drawImage(loadedImages[2], productImageX, productImageY, productImageInnerSize, productImageInnerSize - 10);\n\n\t\t\t\t\t\t// 绘制商品标题\n\t\t\t\t\t\tconst productTitle = store_name;\n\t\t\t\t\t\tconst maxTitleLength = 20; // 标题最大长度\n\t\t\t\t\t\tconst truncatedTitle = truncateTitle(productTitle, maxTitleLength); // 截断标题\n\t\t\t\t\t\tctx.setFontSize(14);\n\t\t\t\t\t\tctx.setTextAlign('center');\n\t\t\t\t\t\tctx.fillText(truncatedTitle, posterWidth / 2, productBorderY + productImageSize + 26);\n\t\t\t\t\t\t// 绘制分享二维码\n\t\t\t\t\t\tconst qrCodeSize = 100;\n\t\t\t\t\t\tconst qrCodeX = (posterWidth - qrCodeSize) / 2;\n\t\t\t\t\t\tconst qrCodeY = productBorderY + productImageSize + 63; // 距离商品标题的间距\n\t\t\t\t\t\tctx.drawImage(loadedImages[4], qrCodeX, qrCodeY, qrCodeSize, qrCodeSize);\n\n\t\t\t\t\t\t// 绘制完成\n\t\t\t\t\t\tctx.draw(false, () => {\n\t\t\t\t\t\t\tconsole.log(posterWidth, posterHeight);\n\t\t\t\t\t\t\t// 生成海报图片\n\t\t\t\t\t\t\tuni.canvasToTempFilePath({\n\t\t\t\t\t\t\t\tcanvasId: 'posterCanvas',\n\t\t\t\t\t\t\t\twidth: posterWidth,\n\t\t\t\t\t\t\t\theight: posterHeight,\n\t\t\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t\t\tconsole.log(res.tempFilePath);\n\t\t\t\t\t\t\t\t\tresolve(res.tempFilePath);\n\t\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tloadImage(src) {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tconst img = new Image();\n\t\t\t\timg.crossOrigin = 'anonymous'; // 允许跨域\n\t\t\t\timg.src = src;\n\t\t\t\timg.onload = () => {\n\t\t\t\t\tconsole.log(img);\n\t\t\t\t\tresolve(img);\n\t\t\t\t};\n\t\t\t\timg.onerror = (err) => reject(err);\n\t\t\t});\n\t\t},\n\t\tshare() {\n\t\t\tthis.$emit('shareH5');\n\t\t},\n\t\tgetPoster() {\n\t\t\tlet images = [this.bag, this.giftBorder, this.giftData.image, this.giftData.avatar, this.PromotionCode];\n\t\t\tconsole.log(images);\n\t\t\tlet postImg = ['', '', '', '', ''];\n\t\t\t// #ifdef MP\n\t\t\tfor (let i = 0; i < images.length; i++) {\n\t\t\t\tuni.downloadFile({\n\t\t\t\t\turl: images[i],\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\t\tpostImg[i] = res.tempFilePath;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.log(i, images.length - 1, postImg);\n\t\t\t\t\t\tconst allNotEmpty = postImg.every((item) => item !== '');\n\t\t\t\t\t\tif (allNotEmpty) this.goPoster(postImg);\n\t\t\t\t\t},\n\t\t\t\t\tfail: function () {\n\t\t\t\t\t\tthis.$set(this, 'PromotionCode', '');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t// #endif\n\t\t\t// #ifndef MP\n\t\t\tthis.goPoster(images);\n\t\t\t// #endif\n\t\t},\n\t\tgoPoster(postImg) {\n\t\t\tthis.drawPoster(postImg, this.giftData.nickname, this.giftData.title)\n\t\t\t\t.then((posterPath) => {\n\t\t\t\t\tconsole.log('海报生成成功:', posterPath);\n\t\t\t\t\t// #ifdef APP-PLUS || MP\n\t\t\t\t\tthis.savePosterPathMp(posterPath);\n\t\t\t\t\t// #endif\n\t\t\t\t\t// #ifdef H5\n\t\t\t\t\tthis.posterImage = posterPath;\n\t\t\t\t\tthis.posterImageStatus = true;\n\t\t\t\t\t// #endif\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tconsole.error('海报生成失败:', err);\n\t\t\t\t});\n\t\t},\n\t\t// #ifdef APP-PLUS || MP\n\t\tsavePosterPathMp(url) {\n\t\t\tlet that = this;\n\t\t\tuni.saveImageToPhotosAlbum({\n\t\t\t\tfilePath: url,\n\t\t\t\tsuccess: function (res) {\n\t\t\t\t\tthat.$util.Tips({\n\t\t\t\t\t\ttitle: that.$t(`保存成功`),\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tfail: function (res) {\n\t\t\t\t\tthat.$util.Tips({\n\t\t\t\t\t\ttitle: that.$t(`保存失败`)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t// #endif\n\t\tsavePic(url) {\n\t\t\tvar a = document.createElement('a'); // 生成一个a元素\n\t\t\ta.download = 'Gift'; // 设置图片名称\n\t\t\ta.style.display = 'none';\n\t\t\ta.href = url; // 将生成的URL设置为a.href属性\n\t\t\tdocument.body.appendChild(a); // 将a标签追加到文档对象中\n\t\t\ta.click(); // 触发a的单击事件\n\t\t\ta.remove(); // 一次性的，用完就删除a标签\n\t\t}\n\t}\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.aleart {\n\twidth: 600rpx;\n\theight: 980rpx;\n\tposition: fixed;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\tz-index: 999;\n\ttop: 50%;\n\tmargin-top: -490rpx;\n\tbackground-color: #fff;\n\tborder-radius: 32rpx;\n\tbackground-size: 100% 100%;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\t.poster-img {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tborder-radius: 32rpx;\n\t}\n\t.from {\n\t\tfont-size: 28rpx;\n\t\tfont-weight: 500;\n\t\tcolor: #333333;\n\t\tmargin-bottom: 16rpx;\n\t}\n\t.message {\n\t\tfont-weight: 400;\n\t\tfont-size: 26rpx;\n\t\tcolor: #999999;\n\t\tmargin-bottom: 42rpx;\n\t}\n\t.aleart-body {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\twidth: 396rpx;\n\t\theight: 419rpx;\n\t\tbackground-image: url('../../static/gift-border.png');\n\t\tbackground-size: 100% 100%;\n\t\tmargin-bottom: 32rpx;\n\t\t.goods-img {\n\t\t\twidth: 360rpx;\n\t\t\theight: 360rpx;\n\t\t\tmargin-top: 24rpx;\n\t\t}\n\t}\n\t.title {\n\t\tmax-width: 80%;\n\t\tfont-weight: 400;\n\t\tfont-size: 28rpx;\n\t\tcolor: #333333;\n\t\tmargin-bottom: 52rpx;\n\t\ttext-align: center;\n\t}\n\t.btn,\n\t.btn-clear {\n\t\twidth: 396rpx;\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\tborder-radius: 20px;\n\t\ttext-align: center;\n\t\tfont-size: 28rpx;\n\t}\n\t.btn {\n\t\tcolor: #fff;\n\t\tbackground: linear-gradient(90deg, #ff7931 0%, #e93323 100%);\n\t}\n\t.btn-clear {\n\t\tmargin-top: 20rpx;\n\t\tcolor: #e93323;\n\t\tborder: 1px solid #e93323;\n\t}\n\t.keep {\n\t\tfont-size: 24rpx;\n\t\tfont-weight: bold;\n\t\tcolor: rgba(255, 255, 255, 0.7);\n\t\tposition: fixed;\n\t\tright: calc(50% - 130rpx);\n\t\tbottom: -45rpx;\n\t\tdisplay: block;\n\t}\n\t.close {\n\t\tfont-size: 50rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #fff;\n\t\tposition: fixed;\n\t\tright: calc(50% - 23rpx);\n\t\tbottom: -110rpx;\n\t\tdisplay: block;\n\t}\n}\n</style>\n","import mod from \"-!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./giftModal.vue?vue&type=style&index=0&id=ac1b5c92&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../../../../download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./giftModal.vue?vue&type=style&index=0&id=ac1b5c92&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1749452851525\n      var cssReload = require(\"D:/download/HBuilderX.4.36.2024112817/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}